import{MongoClient as g,ObjectId as m}from"mongodb";const l=process.env.MONGODB_URL,s=new g(l);s.connect().then(()=>{console.log("[Connected to MongoDB]")}).catch(o=>{console.error("[Error connecting to MongoDB]: ",o)});const p=async o=>{const{animeTags:e,animeId:n}=await o.request.json();if(!e||!e.length||!n)return console.log(typeof n,typeof e),Response.json({message:"Please provide  AnimeTags, and the animeId to proceed with the body"},{status:500});try{const r=s.db().collection("anime"),a=new m(n),c=[{$search:{index:"tags_anime",autocomplete:{query:e,path:"tags"}}},{$match:{_id:{$ne:a}}},{$limit:50}],i=await r.aggregate(c).toArray();return Response.json(i)}catch(t){return console.error(t),Response.json({message:"Something went wrong"},{status:500})}};export{p as POST};
